# v0.1

管理员：
查询教师名单；
添加教师信息；
修改教师信息；
删除教师信息；
查询学生名单；
添加学生信息;
修改学生信息；
删除学生信息；
查询课程信息；
添加课程信息；
修改课程信息；
删除课程信息；
修改登录密码；
教师：
查看个人信息；
查看任课信息；
按照课程表信息开设课程；
取消个人已开课的课程；
按行政班级查看学生均绩及排名;
按任课课程查询学生单门成绩及排名；
按学年查询个人教授课程的平均成绩；
录入学生成绩, 自动更新该学生已修总学分；
修改登录密码；
学生：
查看个人信息；
查看本人课程；
选课与退选；
按学年查询考试成绩；
修改登录密码；

实体关系分析
开设班级，每个班级包含若干学生；
课程由教师开设；
同一门课可能有多个教师开课，一个教师在一学期可能开多门课程；
需要考虑不同学年，并以学年制管理学籍；
不考虑按照班级直接开课的情况，即所有课程均由学生自由选择；
一个学生只能选择某位老师的开的某个课程，即学生不能同时选择同一门两个不同老师开的课程；
不存在两个及以上老师联合开课的情况，即不存在两个及以上教师负责同一教学班的情况。

班级(班级编号, 班级名称)
学生(学号, 姓名, 性别, 年龄, 生源所在地, 已修学分总数, 登录密码, 班级编号)
课程(课程编号, 课程名称, 学时, 考试或考查, 学分)
教师(教师编号, 姓名, 性别, 年龄, 职称, 电话, 登录密码)
开课情况(开课编号，课程编号, 任课教师编号，开课学年, 开课学期，学号，成绩)
选课情况（开课编号，学号，成绩）

1. 班级

| 数据项名 | 数据类型 | 长度 | 完整性约束      | 备注 |
| -------- | -------- | ---- | --------------- | ---- |
| 班级编号 | nvarchar | 4    | 主键，唯一,非空 |      |
| 班级名称 | nvarchar | 20   | 非空            |      |

1. 学生

| 数据项名     | 数据类型 | 长度 | 完整性约束      | 备注 |
| ------------ | -------- | ---- | --------------- | ---- |
| 学号         | nvarchar | 12   | 主键，唯一,非空 |      |
| 姓名         | nvarchar | 5    | 非空            |      |
| 性别         | nvarchar | 1    | 非空            |      |
| 年龄         | int      | 4    | 非空            |      |
| 生源所在地   | nvarchar | 20   | 非空            |      |
| 已修学分总数 | float    | 4    |                 |      |
| 登录密码     | nvarchar | 20   | 非空            |      |
| 班级编号     | nvarchar | 4    | 外键，非空      |      |

1. 课程

| 数据项名   | 数据类型 | 长度 | 完整性约束      | 备注 |
| ---------- | -------- | ---- | --------------- | ---- |
| 课程编号   | nvarchar | 5    | 主键，唯一,非空 |      |
| 课程名称   | nvarchar | 20   | 非空            |      |
| 学时       | int      | 4    | 非空            |      |
| 考试或考查 | bit      | 1    | 非空            |      |
| 学分       | float    | 4    | 非空            |      |

1. 教师

| 数据项名 | 数据类型 | 长度 | 完整性约束       | 备注 |
| -------- | -------- | ---- | ---------------- | ---- |
| 教师编号 | nvarchar | 5    | 主键，唯一，非空 |      |
| 姓名     | nvarchar | 20   | 非空             |      |
| 性别     | nvarchar | 1    | 非空             |      |
| 年龄     | int      | 4    | 非空             |      |
| 职称     | nvarchar | 10   | 非空             |      |
| 电话     | nvarchar | 20   | 非空             |      |
| 登录密码 | nvarchar | 20   | 非空             |      |

1. 开课选课情况

| 数据项名     | 数据类型 | 长度 | 完整性约束       | 备注 |
| ------------ | -------- | ---- | ---------------- | ---- |
| 开课编号     | nvarchar | 15   | 主键，唯一，非空 |      |
| 课程编号     | nvarchar | 5    | 外键，非空       |      |
| 任课教师编号 | nvarchar | 5    | 外键，非空       |      |
| 开课学年     | nvarchar | 4    | 非空             |      |
| 开课学期     | bit      | 1    | 非空             |      |

1. 选课情况

| 数据项名 | 数据类型 | 长度 | 完整性约束           | 备注 |
| -------- | -------- | ---- | -------------------- | ---- |
| 开课编号 | nvarchar | 15   | 联合主键，也均为外键 |      |
| 学号     | nvarchar | 12   |                      |      |
| 成绩     | int      | 4    |                      |      |

---

# v0.1 分析

好的，我对您提供的`需求.md`和`README.md`两个文件进行了详细的分析。总体来说，这是一个非常扎实的项目起点，文档结构清晰，技术选型现代，数据库设计也经过了初步的思考。

下面我将分别从**需求文档**和**设计文档**两个层面，指出可以深化和补充的内容，并针对性地为前端和后端提出建议。

---

### 一、对《需求.md》（软件需求）的分析与补充建议

`需求.md`作为项目的起点，清晰地定义了用户角色和核心功能。但要达到一个完善的软件需求规格说明书（SRS）的标准，我们可以在**广度和深度**上进行扩展。

#### 1. 功能性需求补充 (需要更具体)

当前的功能列表是宏观的，但在开发前需要将其细化为更具体的用户故事或用例。

*   **管理员:**
    *   **批量操作:** 除了单个增删改查，是否需要支持**批量导入**学生/教师信息（例如通过Excel/CSV文件）？这在系统初始化或新学年入学时非常重要。
    *   **密码重置:** 除了“修改个人密码”，管理员是否应该有权限**重置任意用户的密码**？
    *   **系统设置:** 是否需要一个全局设置功能？例如：
        *   **选课时间窗口管理:** 设置选课开始和结束时间。
        *   **学年学期管理:** 创建新的学年和学期，归档旧的数据。

*   **教师:**
    *   **开课细节:** “按照课程表信息开设课程”这个描述可以更具体。教师在开课时，除了选择课程，还需要设置哪些信息？`README.md`中提到了`max_students`（最大选课人数），还应补充：
        *   **上课时间与地点:** 这是避免学生选课冲突的关键信息。
        *   **课程描述/大纲:** 方便学生了解课程内容。
    *   **成绩录入:** “录入学生成绩”是否支持**批量导入**？是否支持**成绩暂存**和**最终提交**两个状态？是否支持平时分、期中分、期末分等**组合成绩**的录入，并自动计算总分？

*   **学生:**
    *   **选课逻辑:** “选课与退选”是核心功能，需要明确以下业务规则：
        *   **选课冲突检测:** 系统应能自动检测并提示**上课时间冲突**的课程。
        *   **先修课程检查:** 是否有课程需要先修完其他课程才能选？（例如，学完“数据结构”才能选“算法设计”）。
        *   **学分限制:** 学生每学期是否有可选的**最低/最高学分**限制？
        *   **选课队列/候补:** 当课程满员时，是否提供**候补（Waitlist）**功能？
    *   **课表功能:** 学生应该能查看自己的**个人课表**，按周/日历视图显示。

#### 2. 非功能性需求补充 (当前完全缺失)

这是需求文档中最重要的补充部分，它定义了系统的质量标准。

*   **性能需求:**
    *   **响应时间:** API平均响应时间应小于200ms，页面加载时间应小于2秒。
    *   **并发用户数:** 系统应能支持至少500名学生同时在线进行选课操作。
*   **安全需求:**
    *   **认证授权:** 明确JWT Token的有效期和刷新机制。
    *   **防注入:** 所有用户输入必须经过严格的后端验证和清理，防止SQL注入和XSS攻击。
    *   **访问控制:** 严格执行基于角色的访问控制，确保学生无法访问教师或管理员的API。
*   **可用性需求:**
    *   **界面友好:** 遵循Material Design规范，确保界面直观、易于操作。
    *   **响应式设计:** 系统应在PC、平板和手机上都有良好的显示和使用体验。
*   **可靠性需求:**
    *   **数据备份:** 数据库应有定期的自动备份机制。
    *   **系统可用性:** 系统应达到99.9%的年可用性。

---

### 二、对《README.md》（设计文档）的分析与补充建议

`README.md`已经是一个非常优秀的开发和部署指南。它更偏向于技术实现和部署，我们可以把它看作一份简化的设计文档。以下是可补充的内容：

#### 1. 后端设计补充 (Backend)

*   **API接口文档 (关键缺失):**
    *   `README.md`只列出了路由文件，但没有定义**具体的API端点**。这是前后端协作的基石。建议使用 **Swagger (OpenAPI)** 规范来定义所有API。
    *   **示例 (管理员添加学生):**
        *   **Endpoint:** `POST /api/admin/students`
        *   **Auth:** `JWT Required (Admin Role)`
        *   **Request Body (JSON):**
            ```json
            {
              "student_id": "202401001001",
              "name": "张三",
              "gender": "男",
              "age": 20,
              "hometown": "北京",
              "class_id": "CS01",
              "password": "initialPassword123"
            }
            ```
        *   **Success Response (201 Created):**
            ```json
            { "message": "学生创建成功" }
            ```
        *   **Error Response (400 Bad Request):**
            ```json
            { "error": "学号已存在" }
            ```
*   **业务逻辑分层:**
    *   目前的设计是`routes`直接调用`models`，对于复杂业务（如选课逻辑、成绩计算）可能会让路由函数变得臃肿。可以考虑增加一个**Service（服务层）**。
    *   **结构示例:**
        ```
        app/
        ├── models/      # 数据库模型
        ├── routes/      # 路由，处理HTTP请求和响应
        └── services/    # 封装核心业务逻辑
            ├── student_service.py # 处理学生选课、查成绩等
            └── teacher_service.py # 处理教师开课、录入成绩等
        ```
    *   **好处:** 路由层更干净，只负责参数校验和调用服务；业务逻辑可以复用和单独测试。

*   **错误处理机制:**
    *   文档提到“完善的错误处理”，但没有具体说明。应定义统一的**API错误响应格式**，方便前端统一处理。
    *   **示例:**
        ```json
        // 404 Not Found
        { "code": 404, "message": "资源未找到" }
        // 403 Forbidden
        { "code": 403, "message": "权限不足" }
        // 500 Internal Server Error
        { "code": 500, "message": "服务器内部错误" }
        ```

#### 2. 前端设计补充 (Frontend)

*   **组件设计与复用:**
    *   `views`目录下是页面级组件。但项目中肯定会有大量可复用的**基础组件**，如数据表格、确认对话框、带搜索/过滤功能的表单等。
    *   建议在`src`下创建一个`components/`目录，存放这些通用组件，并对其功能和props进行文档化（例如使用**Storybook**）。
    *   **示例:** `components/UserDataTable.vue`，可以接收`headers`, `items`, `loading`等props，并发出`on-add`, `on-edit`, `on-delete`等事件。这样在学生管理、教师管理、课程管理页面都可以复用它。

*   **状态管理 (Pinia):**
    *   `auth.js`只处理了认证。可以进一步规划Pinia的使用范围。
    *   **建议创建更多的store:**
        *   `user.js`: 存储当前登录用户的个人信息（profile）。
        *   `app.js`: 存储全局状态，如侧边栏是否折叠、当前系统学年/学期等。
        *   `course.js`: 在选课页面，可以用来管理课程列表、筛选条件、购物车（待选课程）等复杂状态。

*   **UI/UX设计:**
    *   除了ER图，建议补充关键页面的**线框图（Wireframe）**或**UI流程图**。这有助于在编码前明确用户操作路径。
    *   **示例 (学生选课流程):**
        1.  `登录` -> `学生仪表盘`
        2.  `点击"在线选课"` -> `进入选课页面 (CourseEnrollment.vue)`
        3.  `页面显示课程列表（带筛选器和搜索框）`
        4.  `学生点击某门课程的"选课"按钮` -> `系统检查冲突`
        5.  `无冲突` -> `弹出确认对话框` -> `确认后，按钮变为"已选/退选"`
        6.  `有冲突` -> `弹出错误提示 (Toast/Snackbar)`

#### 3. 数据库设计补充

您的数据库设计已经很不错，将“开课”和“选课”分离是非常正确的做法。以下是一些可以使其更健壮的微调和补充：

*   **`course_offerings` (开课情况表) 补充字段:**
    *   **上课时间/地点:** 这是实现课表和冲突检测的核心。
        *   `day_of_week`: INT (1-7)
        *   `start_time`: TIME
        *   `end_time`: TIME
        *   `location`: VARCHAR(50)
    *   `status`: VARCHAR(10) (例如: '开放选课', '已满', '已结束')，方便前端展示课程状态。

*   **`courses` (课程表) 补充关系:**
    *   **先修课程:** 如果需要支持先修课，需要一个关联表。
        *   `course_prerequisites` (course_id, prerequisite_id)

*   **数据类型优化:**
    *   `gender` (性别): 使用 `ENUM('男', '女')` 或 `TINYINT` (0/1) 比 `VARCHAR(1)` 更严谨，节省空间。
    *   `exam_type` (考试类型): `BOOLEAN` / `TINYINT(1)` 是正确的。
    *   `semester` (学期): `BOOLEAN` / `TINYINT(1)` (例如1代表秋季，2代表春季) 比 `bit` 更清晰。
    *   `password`: `VARCHAR(255)` 非常好，可以容纳bcrypt等哈希算法的结果。

### 总结

您的项目已经有了一个非常出色的骨架。

**最高优先级补充：**

1.  **API接口文档 (后端):** 这是打通前后端协作的生命线。使用Swagger/OpenAPI进行定义。
2.  **非功能性需求 (需求文档):** 明确性能、安全等标准，决定了项目的质量和健壮性。
3.  **细化核心功能逻辑 (需求文档):** 特别是选课（冲突、限制）、成绩（组合成绩）等复杂业务规则。

**次高优先级补充：**

1.  **前端组件化设计 (前端):** 规划可复用组件，提高开发效率和一致性。
2.  **后端服务层 (后端):** 引入Service层，让代码结构更清晰，易于维护。
3.  **数据库字段补充 (数据库):** 增加上课时间、地点等字段，使系统功能更完整。

完成了这些补充后，您的需求和设计文档将更加完善，能极大地指导后续的开发工作，减少返工，并确保项目质量。

---

## 非功能性需求

### 1. 性能需求

*   **响应时间:**
    *   API平均响应时间应小于200ms
    *   数据库查询响应时间应小于100ms
    *   页面首次加载时间应小于3秒
    *   页面间跳转响应时间应小于1秒

*   **并发性能:**
    *   在选课高峰期，系统应能支持至少500名学生并发在线操作
    *   教师批量录入成绩时，系统应支持100个并发写操作
    *   管理员批量导入学生信息时，系统应能处理每次1000条记录的导入操作

*   **吞吐量:**
    *   系统应能处理每秒至少100个API请求
    *   数据库应支持每秒至少500次查询操作

*   **资源使用:**
    *   服务器内存使用率在正常负载下应低于70%
    *   CPU使用率在正常负载下应低于60%

### 2. 安全需求

*   **身份认证与授权:**
    *   所有用户密码必须使用bcrypt算法加盐哈希存储，盐长度至少16字符
    *   JWT Token有效期设置为1小时，支持自动刷新机制
    *   实施基于角色的访问控制(RBAC)，严格限制不同角色的操作权限
    *   支持会话超时自动登出，闲置30分钟后强制重新登录

*   **数据安全:**
    *   所有API接口必须验证输入参数，防止SQL注入攻击
    *   前端表单输入必须进行XSS防护处理
    *   敏感数据传输必须使用HTTPS加密
    *   数据库连接必须使用加密连接

*   **操作安全:**
    *   关键操作（删除用户、清空成绩等）必须记录操作日志
    *   管理员权限操作需要二次身份验证
    *   系统应具备基本的防暴力破解机制（连续失败登录锁定账户）
    *   定期强制用户更新密码（建议每6个月）

*   **数据备份:**
    *   数据库应每日自动备份
    *   备份数据应保存至少30天
    *   关键操作前应自动创建数据快照

### 3. 可用性需求

*   **界面设计:**
    *   系统界面需遵循响应式设计原则，在桌面端（1920x1080）、平板端（768x1024）和移动端（375x667）浏览器上均能良好适配
    *   界面应符合无障碍设计标准，支持键盘导航和屏幕阅读器
    *   采用统一的UI设计语言，保持界面风格一致性
    *   重要按钮和链接应有明显的视觉反馈

*   **用户体验:**
    *   关键操作（选课、退选、提交成绩、删除数据）应有二次确认提示
    *   表单验证应实时进行，并提供明确的错误提示信息
    *   长时间操作（如批量导入）应显示进度条
    *   系统应提供操作成功/失败的明确反馈

*   **易用性:**
    *   新用户应能在5分钟内完成基本操作（如学生选课、教师查看课程）
    *   系统应提供在线帮助文档和操作指南
    *   搜索功能应支持模糊搜索和拼音搜索
    *   数据列表应支持排序、筛选和分页功能

*   **兼容性:**
    *   支持主流浏览器：Chrome 90+、Firefox 88+、Safari 14+、Edge 90+
    *   在不同操作系统（Windows、macOS、Linux）上表现一致
    *   支持主流移动浏览器的正常访问

*   **可维护性:**
    *   系统应提供完整的日志记录功能
    *   代码应遵循良好的编程规范，注释率不低于20%
    *   关键模块应有单元测试覆盖，测试覆盖率不低于80%

---
````
